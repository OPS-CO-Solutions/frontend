trigger: none

parameters:
- name: appName
  displayName: 'Azure Web App Name'
  type: string
  default: 'finweb-omar'

variables:
  artifactName: 'frontend'
  azureSubscription: 'AzureDevopsConnection'
  projectName: 'SRE_AZURE_CLASS'

steps:
- task: DownloadPipelineArtifact@2
  displayName: 'Download Latest Artifact from Build Pipeline'
  inputs:
    buildType: 'current'
    project: '$(projectName)'
    definition: 'OPS-CO-Solutions.frontend'    # âœ… Must be pipeline name as string literal
    artifactName: '$(artifactName)'
    targetPath: '$(Pipeline.Workspace)/$(artifactName)'

- task: AzureWebApp@1
  displayName: 'Deploy Frontend to Azure Web App'
  inputs:
    azureSubscription: '$(azureSubscription)'
    appType: 'webAppLinux'
    appName: '${{ parameters.appName }}'
    package: '$(Pipeline.Workspace)/$(artifactName)'
